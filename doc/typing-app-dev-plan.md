# 中学受験タイピングアプリ - Cline開発指示書

このドキュメントは、Clineに段階的に指示を出すための開発手順書です。各ステップをコピー&ペーストしてClineに指示してください。

---

## 📋 プロジェクト初期設定

### Step 1: プロジェクト構造の作成

```markdown
以下の構造で中学受験タイピングアプリのプロジェクトを作成してください:

プロジェクト名: typing-exam-app

ディレクトリ構造:
```
typing-exam-app/
├── index.html
├── css/
│   └── style.css
├── js/
│   ├── main.js
│   ├── game.js
│   ├── storage.js
│   └── data.js
├── assets/
│   ├── sounds/
│   └── images/
└── README.md
```

まず、基本的なindex.htmlを作成し、必要なファイルをリンクしてください。
シンプルで明るい小学生向けのデザインにしてください。
```

---

## 🎯 Phase 1: 基本画面とデータ構造

### Step 2: 問題データの作成

```markdown
js/data.js に中学受験向けの問題データを作成してください。

以下のカテゴリで各30-50問用意してください:
1. 戦国武将
2. 都道府県名
3. 県庁所在地
4. 文豪
5. 星座
6. 歴史人物
7. 四字熟語
8. 理科用語
9. 元素記号
10. 日本の世界遺産

データ構造:
```javascript
const categories = [
  {
    id: 'sengoku',
    name: '戦国武将',
    icon: '⚔️',
    description: '戦国時代の有名な武将たち',
    words: [
      { word: '織田信長', reading: 'おだのぶなが', hint: '天下布武' },
      // ... more words
    ]
  },
  // ... more categories
];
```

実際の中学受験で出題される用語を中心に、正確なデータを作成してください。
```

### Step 3: トップ画面とカテゴリ選択画面

```markdown
index.html にトップ画面とカテゴリ選択画面を実装してください。

要件:
1. タイトル「中学受験タイピングマスター」
2. 「スタート」ボタン
3. カテゴリ選択画面（グリッド表示）
   - 各カテゴリをカード形式で表示
   - カテゴリアイコン、名前、説明を表示
   - ホバーエフェクト付き
4. 「成績を見る」ボタン
5. 小学生が親しみやすいカラフルなデザイン
6. レスポンシブ対応

CSS は style.css に記述してください。
```

---

## 🎮 Phase 2: ゲーム画面の実装

### Step 4: ゲーム画面のHTML/CSS

```markdown
ゲーム画面のUIを作成してください。

画面構成:
1. ヘッダー
   - スコア表示
   - 残り時間表示
   - 現在のコンボ数
   - 進捗バー

2. メインエリア
   - 出題される単語（大きく表示）
   - 読み仮名（小さく表示）
   - ヒント（ある場合）
   
3. 入力エリア
   - 入力フィールド（大きめ、フォーカス自動）
   - 正解/不正解のフィードバック表示エリア

4. フッター
   - 「中断」ボタン

デザイン要件:
- 文字は大きく見やすく
- 入力フィールドは目立つデザイン
- アニメーション用のクラスを用意
```

### Step 5: ゲームロジックの実装

```markdown
js/game.js にゲームのコアロジックを実装してください。

実装する機能:
1. ゲーム初期化
   - 選択されたカテゴリの問題をランダムに取得
   - タイマー開始（60秒）
   - スコア・コンボをリセット

2. 入力判定
   - ユーザー入力と正解を比較
   - 正解時: スコア加算、コンボ増加、次の問題表示
   - 不正解時: コンボリセット、フィードバック表示

3. スコア計算
   - 基本点: 10点
   - コンボボーナス: コンボ数 × 2点
   - 速度ボーナス: 入力速度に応じて加点

4. タイマー機能
   - カウントダウン表示
   - 0秒で自動的に結果画面へ遷移

5. ゲーム終了処理
   - 最終スコア計算
   - 統計データ収集（正解数、正解率、平均速度など）
   - 結果データをstorageに保存

クラス構造:
```javascript
class Game {
  constructor(category) { }
  start() { }
  checkAnswer(input) { }
  nextQuestion() { }
  updateTimer() { }
  calculateScore() { }
  endGame() { }
}
```
```

### Step 6: エフェクトとアニメーション

```markdown
ゲーム画面に以下のエフェクトを追加してください:

1. 正解時のエフェクト
   - 「正解!」テキストのフェードイン/アウト
   - スコア加算アニメーション
   - 画面全体に軽いフラッシュ（緑系）

2. 不正解時のエフェクト
   - 「不正解」テキスト表示
   - 入力フィールドを赤く点滅

3. コンボエフェクト
   - コンボ数が5, 10, 20, 50に達したとき特別な演出
   - 「Great!」「Excellent!」「Amazing!」などのメッセージ
   - コンボ数の拡大アニメーション

4. タイマー警告
   - 残り10秒で赤く点滅

CSSアニメーションとJavaScriptを組み合わせて実装してください。
```

---

## 📊 Phase 3: 結果画面と称号システム

### Step 7: 結果画面の実装

```markdown
結果画面を実装してください。

表示内容:
1. 称号の大きな表示（アニメーション付き）
2. 総合スコア
3. 詳細統計
   - 正解数 / 総問題数
   - 正解率 (%)
   - 平均入力速度 (文字/秒)
   - 最大コンボ数
   - かかった時間

4. ボタン
   - 「もう一度」
   - 「カテゴリ選択に戻る」
   - 「成績を見る」

称号システム:
スコアに基づいて以下の称号を判定してください:
- 0-20点: 見習い
- 21-40点: 一般人
- 41-60点: 秀才
- 61-75点: 天才
- 76-85点: 神童
- 86-92点: 伝説
- 93-97点: 界王
- 98-99点: 界王神
- 100点: タイピング神

特別称号:
- 完璧主義者: ミスなしクリア
- 光速の指: 平均入力速度5文字/秒以上

称号は大きなフォントでアニメーション表示してください。
```

### Step 8: ローカルストレージ実装

```markdown
js/storage.js にデータ保存・読み込み機能を実装してください。

実装する関数:
1. saveGameResult(result)
   - ゲーム結果をlocalStorageに保存
   - データ構造: { id, timestamp, category, score, accuracy, speed, time, rank, combo }

2. getGameHistory()
   - すべてのゲーム履歴を取得
   - 日付の新しい順にソート

3. getStatistics()
   - 統計情報を計算
   - 総ゲーム数、平均スコア、最高スコア、カテゴリ別統計など

4. clearHistory()
   - 履歴をクリア（確認ダイアログ付き）

5. getCategoryStats(categoryId)
   - 特定カテゴリの統計を取得

localStorage のキー:
- 'typingApp_history': ゲーム履歴の配列
- 'typingApp_stats': 統計情報
```

---

## 📈 Phase 4: 成績画面と統計

### Step 9: 成績一覧画面

```markdown
成績一覧画面を実装してください。

表示内容:
1. 総合統計
   - 総プレイ回数
   - 平均スコア
   - 最高スコア
   - 最高称号
   - お気に入りカテゴリ

2. プレイ履歴テーブル
   - 日時、カテゴリ、スコア、正解率、称号を表示
   - ページネーション（10件ずつ）
   - ソート機能（日時順、スコア順）

3. フィルター機能
   - カテゴリでフィルター
   - 日付範囲でフィルター

4. スコア推移グラフ
   - 直近10回のスコア推移を折れ線グラフで表示
   - 簡易的なグラフでOK（CanvasまたはCSS）

5. カテゴリ別統計
   - 各カテゴリのプレイ回数と平均スコアを表示

ボタン:
- 「トップに戻る」
- 「履歴をクリア」
```

### Step 10: グラフ機能の追加

```markdown
成績画面にグラフを追加してください。

実装するグラフ:
1. スコア推移グラフ（折れ線グラフ）
   - X軸: プレイ回数または日付
   - Y軸: スコア
   - 直近20回分を表示

2. カテゴリ別プレイ回数（棒グラフ）
   - X軸: カテゴリ名
   - Y軸: プレイ回数

3. 正解率の推移（折れ線グラフ）

実装方法:
- Canvas APIを使用
- またはシンプルなCSS棒グラフ
- レスポンシブ対応

色使いは子供向けにカラフルで見やすく。
```

---

## 🎨 Phase 5: UI/UX改善

### Step 11: レスポンシブデザイン

```markdown
すべての画面をレスポンシブ対応してください。

対応デバイス:
- デスクトップ（1200px以上）
- タブレット（768px - 1199px）
- スマートフォン（767px以下）

調整項目:
1. カテゴリ選択のグリッド
   - デスクトップ: 3-4列
   - タブレット: 2-3列
   - スマホ: 1-2列

2. ゲーム画面
   - フォントサイズの調整
   - 入力フィールドの幅調整

3. 成績画面
   - テーブルをスクロール可能に
   - グラフのサイズ調整

メディアクエリを使用して適切に調整してください。
```

### Step 12: アクセシビリティ改善

```markdown
アクセシビリティを向上させてください:

1. キーボード操作対応
   - Tabキーでフォーカス移動
   - Enterキーで決定
   - Escキーでキャンセル/戻る

2. フォーカス表示
   - フォーカスされている要素を明確に表示

3. セマンティックHTML
   - 適切なHTML5タグを使用（header, main, section, article）

4. ARIA属性
   - ボタンやフォームに適切なaria-label

5. 色のコントラスト
   - 文字と背景のコントラスト比を確保

6. エラーメッセージ
   - 分かりやすいエラー表示
```

---

## 🔊 Phase 6: サウンドとエフェクト

### Step 13: 効果音の実装

```markdown
効果音を追加してください。

必要な効果音:
1. 正解時: 「ピンポン」
2. 不正解時: 「ブー」
3. コンボ達成時: 「キラキラ」
4. ゲーム終了時: 「ファンファーレ」
5. ボタンクリック時: 「カチッ」

実装方法:
- Web Audio APIまたはHTML5 Audioを使用
- フリー素材サイトから音源を取得（例: 効果音ラボ）
- 設定で音のON/OFFを切り替え可能に

設定画面:
- 「設定」ボタンをヘッダーに追加
- モーダルまたはサイドバーで表示
- 効果音のON/OFF
- BGMのON/OFF（将来的に）
- 音量調整スライダー
```

### Step 14: パーティクルエフェクト

```markdown
正解時のパーティクルエフェクトを追加してください。

実装内容:
1. 正解時に画面中央から星や光のパーティクルが放射状に広がる
2. コンボが続くほど派手なエフェクトになる
3. パフォーマンスを考慮した軽量な実装

実装方法:
- Canvas APIを使用
- または CSS animationで星を複数生成

色:
- 正解: 黄色・金色系
- コンボ達成: 虹色

エフェクトは1-2秒で消えるようにしてください。
```

---

## 🎯 Phase 7: 追加機能

### Step 15: ゲームモード追加

```markdown
複数のゲームモードを追加してください。

モード選択画面:
カテゴリ選択後、以下のモードを選択できるようにしてください:

1. タイムアタック（デフォルト）
   - 60秒で何問解けるか

2. 30秒チャレンジ
   - 30秒の短期集中モード

3. 完璧クリア
   - 時間無制限、ミス3回でゲームオーバー
   - 全問正解を目指す

4. サバイバル
   - 時間制限なし、ミス1回でゲームオーバー
   - 何問連続正解できるか

各モードに応じてスコア計算やUI表示を調整してください。
```

### Step 16: コンボシステムの強化

```markdown
コンボシステムを強化してください:

1. コンボによるスコア倍率
   - 5コンボ: 1.2倍
   - 10コンボ: 1.5倍
   - 20コンボ: 2.0倍
   - 30コンボ以上: 2.5倍

2. コンボメッセージ
   - 5コンボ: "Good!"
   - 10コンボ: "Great!"
   - 20コンボ: "Excellent!"
   - 30コンボ: "Perfect!"
   - 50コンボ: "AMAZING!!!"

3. コンボゲージ
   - 視覚的にコンボ数を表示
   - ゲージがいっぱいになると特別ボーナス

4. 最大コンボ記録
   - ゲーム終了時に表示
   - 自己ベスト更新時は特別演出

画面にコンボメーターを追加し、視覚的に分かりやすくしてください。
```

### Step 17: 実績システム

```markdown
実績解除システムを実装してください。

実績一覧:
1. 「はじめの一歩」- 初プレイ
2. 「継続は力なり」- 5回プレイ
3. 「努力家」- 50回プレイ
4. 「スピードスター」- 平均入力速度5文字/秒達成
5. 「光速の指」- 平均入力速度7文字/秒達成
6. 「完璧主義者」- ミスなしクリア
7. 「天才の片鱗」- スコア80点以上
8. 「神の領域」- スコア95点以上
9. 「コンボマスター」- 30コンボ達成
10. 「全カテゴリ制覇」- すべてのカテゴリをプレイ

実装内容:
- 実績データをlocalStorageに保存
- 実績解除時にモーダルでお祝い表示
- 実績一覧画面を作成（達成/未達成を表示）
- 進捗バー表示（一部の実績）

実績画面へのリンクをヘッダーに追加してください。
```

---

## 🎉 Phase 8: 仕上げと最適化

### Step 18: ローディング画面

```markdown
ローディング画面を実装してください:

1. アプリ起動時
   - ロゴ表示
   - プログレスバー
   - 「読み込み中...」メッセージ

2. ゲーム開始時
   - 「3, 2, 1, Start!」のカウントダウン表示
   - アニメーション付き

3. 画面遷移時
   - スムーズなフェードイン/アウト

デザインは明るく楽しい雰囲気で。
```

### Step 19: エラーハンドリング

```markdown
エラーハンドリングを追加してください:

1. データ保存失敗時
   - ユーザーに通知
   - リトライ機能

2. localStorage容量不足
   - 古いデータを削除する提案

3. データ読み込み失敗
   - デフォルトデータで続行

4. 入力検証
   - 空入力のチェック
   - 特殊文字のサニタイズ

5. ブラウザ互換性
   - localStorage非対応ブラウザへの対応
   - モダンブラウザの推奨メッセージ

エラーメッセージは小学生にも分かりやすい表現で。
```

### Step 20: パフォーマンス最適化

```markdown
パフォーマンスを最適化してください:

1. 画像の最適化
   - 画像を圧縮
   - 必要に応じてWebP形式

2. CSSの最適化
   - 不要なスタイルを削除
   - CSSを結合・圧縮

3. JavaScriptの最適化
   - 不要なコードを削除
   - イベントリスナーの適切な管理
   - メモリリークの防止

4. 遅延読み込み
   - 画像の遅延読み込み
   - 非同期スクリプト読み込み

5. キャッシュ活用
   - サービスワーカーの実装（オプション）

6. デバッグコードの削除
   - console.logの削除

ページ読み込み時間を2秒以内に最適化してください。
```

---

## 📱 Phase 9: 追加改善

### Step 21: ヘルプ・チュートリアル

```markdown
初回プレイ時のチュートリアルを追加してください:

1. 初回起動時
   - 簡単な使い方説明（モーダル表示）
   - 「もう表示しない」チェックボックス

2. ヘルプボタン
   - ヘッダーに「？」ボタン
   - 遊び方の説明ページ

説明内容:
- ゲームの目的
- 操作方法
- スコアの計算方法
- 称号について
- コンボシステム

図解やアニメーションを使って分かりやすく説明してください。
```

### Step 22: デイリーチャレンジ

```markdown
デイリーチャレンジ機能を追加してください:

機能概要:
1. 毎日決まった問題セットが出題される
2. その日の問題は全ユーザー共通
3. 1日1回のみプレイ可能
4. 特別な称号がもらえる

実装内容:
- 日付ベースでシード値を生成
- そのシード値で問題をシャッフル
- プレイ済みかどうかをlocalStorageでチェック
- デイリーチャレンジ専用の結果画面
- 「次回は○○時○○分から」と表示

トップ画面に「今日のチャレンジ」ボタンを追加してください。
```

---

## 🧪 Phase 10: テストとデバッグ

### Step 23: テスト項目の実行

```markdown
以下の項目をテストしてデバッグしてください:

機能テスト:
- [ ] すべてのカテゴリで正常にゲームが開始できる
- [ ] タイマーが正確にカウントダウンされる
- [ ] 正解判定が正しく動作する
- [ ] スコア計算が正確
- [ ] データが正しく保存・読み込みされる
- [ ] すべてのボタンが機能する
- [ ] 画面遷移がスムーズ
- [ ] 効果音が再生される
- [ ] エフェクトが表示される

ブラウザテスト:
- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Edge

レスポンシブテスト:
- [ ] デスクトップ（1920x1080）
- [ ] タブレット（768x1024）
- [ ] スマートフォン（375x667）

問題があれば修正してください。
```

### Step 24: 最終調整

```markdown
最終調整を行ってください:

1. UI/UXの微調整
   - ボタンサイズの統一
   - 余白の調整
   - 色の統一感チェック

2. テキストの確認
   - 誤字脱字チェック
   - 分かりやすい表現に修正

3. パフォーマンスチェック
   - ページ読み込み速度
   - アニメーションの滑らかさ

4. README.mdの作成
   - プロジェクト概要
   - 機能一覧
   - 技術スタック
   - セットアップ方法
   - 今後の開発予定

5. コメントの追加
   - 重要な関数にコメント
   - 複雑なロジックに説明

6. コードの整形
   - インデントの統一
   - 命名規則の統一
```

---

## 🚀 オプション機能（余裕があれば）

### Option 1: SNSシェア機能

```markdown
SNSシェア機能を追加してください:

実装内容:
1. 結果画面に「シェア」ボタン
2. シェア用の画像を動的に生成（Canvas API）
   - スコア
   - 称号
   - カテゴリ名
3. Twitter/Facebook/LINEでシェア
4. クリップボードにコピー機能

シェアテキスト例:
「中学受験タイピングマスターで『界王神』の称号を獲得！スコア98点 #タイピング #中学受験」
```

### Option 2: ダークモード

```markdown
ダークモードを実装してください:

実装内容:
1. 設定にダークモード切り替えスイッチ
2. CSSカスタムプロパティでテーマ管理
3. localStorage にテーマ設定を保存
4. システム設定を自動検出（prefers-color-scheme）

カラースキーム:
- ライトモード: 明るい背景、濃い文字
- ダークモード: 暗い背景、明るい文字

目に優しい色合いで実装してください。
```

### Option 3: ランキング機能（Firebase使用）

```markdown
※これはFirebaseのセットアップが必要です

オンラインランキング機能を実装してください:

実装内容:
1. Firebaseのセットアップ
2. スコア送信機能
3. ランキング取得・表示
   - デイリーランキング
   - ウィークリーランキング
   - カテゴリ別ランキング
4. 不正対策（基本的なバリデーション）

ランキング画面:
- トップ100を表示
- 自分の順位を強調表示
- ニックネーム登録機能（オプション）
```

---

## ✅ 完成チェックリスト

最後に以下をチェックしてください:

```markdown
□ すべての画面が実装されている
□ すべての機能が正常に動作する
□ レスポンシブデザインが適用されている
□ エラーハンドリングが実装されている
□ パフォーマンスが最適化されている
□ コードが整理されている
□ README.mdが完成している
□ 問題データが充実している（各カテゴリ30問以上）
□ 効果音が実装されている
□ アニメーションが実装されている
□ 各種ブラウザで動作確認済み
□ スマートフォンで動作確認済み
```

---

## 🎓 使い方のコツ

Clineへの指示方法:
1. 各Stepを順番にコピー＆ペースト
2. 実装が完了したら動作確認
3. 問題があれば詳細を伝えて修正依頼
4. 次のStepに進む

効率的な開発のために:
- 1つのStepが完了してから次に進む
- 定期的にブラウザで動作確認
- 問題点はメモしておく
- 大きな変更の前にバックアップ

これで完璧なタイピングアプリが完成します！🎉